import{GLTFLoader as m,ArrayItem as h}from"./glTFLoader-BdFMiwN_.js";import{b as i,an as p,ao as _}from"./index-DtxP6EWh.js";import"./index-D4AkeOnM.js";import"./svelte/svelte.js";import"./bone-Ac0Tz5sQ.js";import"./rawTexture-C3sSfSnB.js";import"./assetContainer-C1N3TjNO.js";import"./objectModelMapping-CWxJezgv.js";let f=0,d=null;class r{static get Default(){return r._Default||(r._Default=new r),r._Default}constructor(){const e=r.Configuration.decoder;this._decoderModulePromise=i.LoadBabylonScriptAsync(e.url).then(()=>MeshoptDecoder.ready)}dispose(){delete this._decoderModulePromise}decodeGltfBufferAsync(e,s,n,t,o){return this._decoderModulePromise.then(async()=>{f===0&&(MeshoptDecoder.useWorkers(1),f=1);const u=await MeshoptDecoder.decodeGltfBufferAsync(s,n,e,t,o);return d!==null&&clearTimeout(d),d=setTimeout(()=>{MeshoptDecoder.useWorkers(0),f=0,d=null},1e3),u})}}r.Configuration={decoder:{url:`${i._DefaultCdnUrl}/meshopt_decoder.js`}};r._Default=null;const a="EXT_meshopt_compression";class D{constructor(e){this.name=a,this.enabled=e.isExtensionUsed(a),this._loader=e}dispose(){this._loader=null}loadBufferViewAsync(e,s){return m.LoadExtensionAsync(e,s,this.name,(n,t)=>{const o=s;if(o._meshOptData)return o._meshOptData;const u=h.Get(`${e}/buffer`,this._loader.gltf.buffers,t.buffer);return o._meshOptData=this._loader.loadBufferAsync(`/buffers/${u.index}`,u,t.byteOffset||0,t.byteLength).then(c=>r.Default.decodeGltfBufferAsync(c,t.count,t.byteStride,t.mode,t.filter)),o._meshOptData})}}p(a);_(a,!0,l=>new D(l));export{D as EXT_meshopt_compression};
//# sourceMappingURL=EXT_meshopt_compression-Evlh0DIv.js.map
